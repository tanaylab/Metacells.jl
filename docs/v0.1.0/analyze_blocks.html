
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Analyze Blocks · Metacells.jl v0.1.0
</title>
<meta name="title" content="Analyze Blocks · Metacells.jl v0.1.0"/>
<meta property="og:title" content="Analyze Blocks · Metacells.jl v0.1.0"/>
<meta property="twitter:title" content="Analyze Blocks · Metacells.jl v0.1.0"/>
<meta name="description" content="Documentation for Metacells.jl v0.1.0."/>
<meta property="og:description" content="Documentation for Metacells.jl v0.1.0."/>
<meta property="twitter:description" content="Documentation for Metacells.jl v0.1.0."/>
<script data-outdated-warner src="assets/warner.js">
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/>
<script>documenterBaseURL="."
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js">
</script>
<script src="search_index.js">
</script>
<script src="siteinfo.js">
</script>
<script src="../versions.js">
</script>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/>
<link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/>
<script src="assets/themeswap.js">
</script>
</head>
<body>
<div id="documenter">
<nav class="docs-sidebar">
<div class="docs-package-name">
<span class="docs-autofit">
<a href="index.html">Metacells.jl v0.1.0
</a>
</span>
</div>
<button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)
</button>
<ul class="docs-menu">
<li>
<a class="tocitem" href="index.html">Metacells
</a>
</li>
<li>
<a class="tocitem" href="gmara.html">Gmara
</a>
</li>
<li>
<a class="tocitem" href="contracts.html">Contracts
</a>
</li>
<li>
<a class="tocitem" href="analyze_cells.html">Analyze Cells
</a>
</li>
<li>
<a class="tocitem" href="analyze_metacells.html">Analyze Metacells
</a>
</li>
<li>
<a class="tocitem" href="compute_blocks.html">Compute Blocks
</a>
</li>
<li class="is-active">
<a class="tocitem" href="analyze_blocks.html">Analyze Blocks
</a>
<ul class="internal">
<li>
<a class="tocitem" href="#Counts">
<span>Counts
</span>
</a>
</li>
<li>
<a class="tocitem" href="#UMIs">
<span>UMIs
</span>
</a>
</li>
<li>
<a class="tocitem" href="#Fractions">
<span>Fractions
</span>
</a>
</li>
<li>
<a class="tocitem" href="#Genes">
<span>Genes
</span>
</a>
</li>
<li>
<a class="tocitem" href="#Index">
<span>Index
</span>
</a>
</li>
</ul>
</li>
<li>
<a class="tocitem" href="compute_modules.html">Compute Modules
</a>
</li>
<li>
<a class="tocitem" href="analyze_modules.html">Analyze Modules
</a>
</li>
<li>
<a class="tocitem" href="compute_approximation.html">Compute Approximation
</a>
</li>
<li>
<a class="tocitem" href="analyze_approximation.html">Analyze Approximation
</a>
</li>
<li>
<a class="tocitem" href="sharpen_metacells.html">Sharpen Metacells
</a>
</li>
<li>
<a class="tocitem" href="anndata_format.html">AnnData Format
</a>
</li>
<li>
<a class="tocitem" href="defaults.html">Defaults
</a>
</li>
</ul>
<div class="docs-version-selector field has-addons">
<div class="control">
<span class="docs-label button is-static is-size-7">Version
</span>
</div>
<div class="docs-selector control is-expanded">
<div class="select is-fullwidth is-size-7">
<select id="documenter-version-selector">
</select>
</div>
</div>
</div>
</nav>
<div class="docs-main">
<header class="docs-navbar">
<a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#">
</a>
<nav class="breadcrumb">
<ul class="is-hidden-mobile">
<li class="is-active">
<a href="analyze_blocks.html">Analyze Blocks
</a>
</li>
</ul>
<ul class="is-hidden-tablet">
<li class="is-active">
<a href="analyze_blocks.html">Analyze Blocks
</a>
</li>
</ul>
</nav>
<div class="docs-right">
<a class="docs-navbar-link" href="https://github.com/tanaylab/Metacells.jl/blob/main{path}?plain=1#L{line}" title="View the repository on GitHub">
<span class="docs-icon fa-brands">
</span>
<span class="docs-label is-hidden-touch">GitHub
</span>
</a>
<a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings">
</a>
<a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings">
</a>
</div>
</header>
<article class="content" id="documenter-page">
<h1 id="Analyze-Blocks">
<a class="docs-heading-anchor" href="#Analyze-Blocks">Analyze Blocks
</a>
<a id="Analyze-Blocks-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Analyze-Blocks" title="Permalink">
</a>
</h1>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks" href="#Metacells.AnalyzeBlocks">
<code>Metacells.AnalyzeBlocks
</code>
</a> — 
<span class="docstring-category">Module
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<p>Do simple blocks analysis.
</p>
</div>
</section>
</article>
<h2 id="Counts">
<a class="docs-heading-anchor" href="#Counts">Counts
</a>
<a id="Counts-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Counts" title="Permalink">
</a>
</h2>
<h3 id="Cells">
<a class="docs-heading-anchor" href="#Cells">Cells
</a>
<a id="Cells-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Cells" title="Permalink">
</a>
</h3>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_n_cells!" href="#Metacells.AnalyzeBlocks.compute_blocks_n_cells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_cells!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_n_cells!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of cells per block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>metacell
</strong> (required): Minimal-sized groups of cells for robust point estimates.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>metacell @ n_cells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The number of cells in each metacell.
</p>
<p>
<strong>metacell @ block
</strong>::AbstractString (required): The unique block each metacell belongs to.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ n_cells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The number of cells in the metacells in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_cells!" href="#Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_cells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_cells!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_n_neighborhood_cells!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of cells in the metacells of the blocks of the neighborhood centered at a block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>metacell
</strong> (required): Minimal-sized groups of cells for robust point estimates.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>metacell @ n_cells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The number of cells in each metacell.
</p>
<p>
<strong>metacell @ block
</strong>::AbstractString (required): The unique block each metacell belongs to.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>block, block @ is
<em>in
</em>neighborhood
</strong>::Bool (required): For each block, the (column) mask of nearby blocks in its immediate neighborhood.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ n
<em>neighborhood
</em>cells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of cells in the metacells in the blocks of the neighborhood centered at each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_n_environment_cells!" href="#Metacells.AnalyzeBlocks.compute_blocks_n_environment_cells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_environment_cells!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_n_environment_cells!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of cells in the metacells of the blocks of the environment centered at each block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>metacell
</strong> (required): Minimal-sized groups of cells for robust point estimates.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>metacell @ n_cells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The number of cells in each metacell.
</p>
<p>
<strong>metacell @ block
</strong>::AbstractString (required): The unique block each metacell belongs to.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>block, block @ is
<em>in
</em>environment
</strong>::Bool (required): For each block, the (column) mask of nearby blocks in its expanded environment.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ n
<em>environment
</em>cells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of cells in the metacells in the blocks of the environment centered at each block.
</p>
</div>
</section>
</article>
<h3 id="Metacells">
<a class="docs-heading-anchor" href="#Metacells">Metacells
</a>
<a id="Metacells-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Metacells" title="Permalink">
</a>
</h3>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_n_metacells!" href="#Metacells.AnalyzeBlocks.compute_blocks_n_metacells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_metacells!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_n_metacells!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of metacells per block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>metacell
</strong> (required): Minimal-sized groups of cells for robust point estimates.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>metacell @ block
</strong>::AbstractString (required): The unique block each metacell belongs to.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ n_metacells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The number of metacells in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_metacells!" href="#Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_metacells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_metacells!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_n_neighborhood_metacells!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of metacells in the blocks of the neighborhood centered at each block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>metacell
</strong> (required): Minimal-sized groups of cells for robust point estimates.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>metacell @ block
</strong>::AbstractString (required): The unique block each metacell belongs to.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>block, block @ is
<em>in
</em>neighborhood
</strong>::Bool (required): For each block, the (column) mask of nearby blocks in its immediate neighborhood.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ n
<em>neighborhood
</em>metacells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of metacells in the blocks of the neighborhood centered at each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_n_environment_metacells!" href="#Metacells.AnalyzeBlocks.compute_blocks_n_environment_metacells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_environment_metacells!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_n_environment_metacells!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of metacells in the blocks of the environment centered at each block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>metacell
</strong> (required): Minimal-sized groups of cells for robust point estimates.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>metacell @ block
</strong>::AbstractString (required): The unique block each metacell belongs to.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>block, block @ is
<em>in
</em>environment
</strong>::Bool (required): For each block, the (column) mask of nearby blocks in its expanded environment.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ n
<em>environment
</em>metacells
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of metacells in the blocks of the environment centered at each block.
</p>
</div>
</section>
</article>
<h3 id="Blocks">
<a class="docs-heading-anchor" href="#Blocks">Blocks
</a>
<a id="Blocks-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Blocks" title="Permalink">
</a>
</h3>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_blocks!" href="#Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_blocks!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_blocks!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_n_neighborhood_blocks!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of blocks in the neighborhood centered at each block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>block, block @ is
<em>in
</em>neighborhood
</strong>::Bool (required): For each block, the (column) mask of nearby blocks in its immediate neighborhood.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ n
<em>neighborhood
</em>blocks
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of blocks in the neighborhood centered at each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_n_environment_blocks!" href="#Metacells.AnalyzeBlocks.compute_blocks_n_environment_blocks!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_environment_blocks!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_n_environment_blocks!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of blocks in the environment centered at each block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>block, block @ is
<em>in
</em>environment
</strong>::Bool (required): For each block, the (column) mask of nearby blocks in its expanded environment.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ n
<em>environment
</em>blocks
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of blocks in the environment centered at each block.
</p>
</div>
</section>
</article>
<h2 id="UMIs">
<a class="docs-heading-anchor" href="#UMIs">UMIs
</a>
<a id="UMIs-1">
</a>
<a class="docs-heading-anchor-permalink" href="#UMIs" title="Permalink">
</a>
</h2>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_UMIs!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_UMIs!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_UMIs!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total number of UMIs used to estimate the fraction of each gene in each block. This can used to estimate the robustness of the fraction.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>metacell
</strong> (required): Minimal-sized groups of cells for robust point estimates.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>metacell @ block
</strong>::AbstractString (required): The unique block each metacell belongs to.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, metacell @ UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The total number of UMIs used to estimate the fraction of each gene in each metacell.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of UMIs used to estimate the fraction of each gene in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_total_UMIs!" href="#Metacells.AnalyzeBlocks.compute_blocks_total_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_total_UMIs!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_total_UMIs!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total UMIs of genes per block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The total number of UMIs used to estimate the fraction of each gene in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ total_UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of UMIs used to estimate the fraction of all the genes in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_scaled_total_UMIs!" href="#Metacells.AnalyzeBlocks.compute_blocks_scaled_total_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_scaled_total_UMIs!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_scaled_total_UMIs!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total UMIs of genes per block, scaled by divergence.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>gene @ divergence
</strong>::Union{Float32, Float64} (required): Scale fold factors of each gene by multiplying with (1 - divergence) of the gene.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The total number of UMIs used to estimate the fraction of each gene in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ scaled
<em>total
</em>UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of UMIs used to estimate the fraction of all the genes in each block, scaled by divergence.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_covered_UMIs!" href="#Metacells.AnalyzeBlocks.compute_blocks_covered_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_covered_UMIs!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_covered_UMIs!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total UMIs of covered genes per block.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>gene @ is_covered
</strong>::Bool (required): A mask of genes that are covered by the local linear program.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The total number of UMIs used to estimate the fraction of each gene in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ covered_UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of the covered genes in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_scaled_covered_UMIs!" href="#Metacells.AnalyzeBlocks.compute_blocks_scaled_covered_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_scaled_covered_UMIs!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_scaled_covered_UMIs!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The total UMIs of covered genes per block, scaled by divergence.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>gene @ divergence
</strong>::Union{Float32, Float64} (required): Scale fold factors of each gene by multiplying with (1 - divergence) of the gene.
</p>
<p>
<strong>gene @ is_covered
</strong>::Bool (required): A mask of genes that are covered by the local linear program.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The total number of UMIs used to estimate the fraction of each gene in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ scaled
<em>covered
</em>UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (guaranteed): The total number of the covered genes in each block, scaled by divergence.
</p>
</div>
</section>
</article>
<h2 id="Fractions">
<a class="docs-heading-anchor" href="#Fractions">Fractions
</a>
<a id="Fractions-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Fractions" title="Permalink">
</a>
</h2>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_linear_fractions!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_linear_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_linear_fractions!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_linear_fractions!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>An estimated linear fraction of the UMIs of each gene in each block. This is just the total UMIs of the gene in the metacell divided by the total UMIs of the metacell, which is the &quot;best&quot; estimate assuming multinomial sampling noise. However, this is sensitive to a few metacells with very high expression levels (&quot;bursty&quot; genes).
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>gene @ is_excluded
</strong>::Bool (required): A mask of genes that are totally excluded from the analysis.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The total number of UMIs used to estimate the fraction of each gene in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ linear_fraction
</strong>::Union{Float32, Float64} (guaranteed): The estimated linear fraction of the UMIs of each gene out of the total UMIs in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_fractions!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_fractions!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_scaled_linear_fractions!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The estimated linear fraction of the UMIs of each gene in each block, scaled by divergence. We apply this scaling to reduce the disproportionate impact of highly variable (&quot;bursty&quot;) genes when using square-error methods.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>gene @ divergence
</strong>::Union{Float32, Float64} (required): Scale fold factors of each gene by multiplying with (1 - divergence) of the gene.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ linear_fraction
</strong>::Union{Float32, Float64} (required): The estimated linear fraction of the UMIs of each gene out of the total UMIs in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ scaled
<em>linear
</em>fraction
</strong>::Union{Float32, Float64} (guaranteed): The estimated linear fraction of the UMIs of each gene out of the total UMIs in each block, scaled by divergence.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_fractions!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_fractions!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_log_linear_fractions!(
    daf::DafWriter;
    gene_fraction_regularization::AbstractFloat = ```1.0e-5```,
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The log base 2 of the estimated linear fraction of the UMIs of each gene in each block. This adds the 
<code>gene_fraction_regularization
</code> to deal with zero fractions.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ linear_fraction
</strong>::Union{Float32, Float64} (required): The estimated linear fraction of the UMIs of each gene out of the total UMIs in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ log
<em>linear
</em>fraction
</strong>::Union{Float32, Float64} (guaranteed): The log base 2 of the estimated linear fraction of the UMIs of each gene out of the total UMIs in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_fractions!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_fractions!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_log_scaled_linear_fractions!(
    daf::DafWriter;
    gene_fraction_regularization::AbstractFloat = ```1.0e-5```,
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The estimated linear fraction of the UMIs of each gene in each block, scaled by divergence. We apply this scaling to reduce the disproportionate impact of highly variable (&quot;bursty&quot;) genes when using square-error methods.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ scaled
<em>linear
</em>fraction
</strong>::Union{Float32, Float64} (required): The estimated linear fraction of the UMIs of each gene out of the total UMIs in each block, scaled by divergence.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ log
<em>scaled
</em>linear_fraction
</strong>::Union{Float32, Float64} (guaranteed): The log base 2 of the scaled estimated linear fraction of the UMIs of each gene out of the total UMIs in each block, scaled by divergence.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_linear_covered_fractions!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_linear_covered_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_linear_covered_fractions!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_linear_covered_fractions!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>An estimated linear fraction of the UMIs of each covered gene in each block. By considering only the covered genes this avoid the impact of highly-expressed lateral genes (e.g., cell cycle). Otherwise is similar to 
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_linear_fractions!">
<code>compute_blocks_genes_linear_fractions!
</code>
</a>.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>gene @ is_covered
</strong>::Bool (required): A mask of genes that are covered by the local linear program.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ UMIs
</strong>::Union{UInt16, UInt32, UInt64, UInt8} (required): The total number of UMIs used to estimate the fraction of each gene in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ linear
<em>covered
</em>fraction
</strong>::Union{Float32, Float64} (guaranteed): The estimated linear fraction of the UMIs of each covered gene out of the total covered UMIs in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_covered_fractions!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_covered_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_covered_fractions!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_scaled_linear_covered_fractions!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The estimated linear fraction of the UMIs of each covered gene in each block, scaled by divergence. We apply this scaling to reduce the disproportionate impact of highly variable (&quot;bursty&quot;) genes when using square-error methods.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>gene @ divergence
</strong>::Union{Float32, Float64} (required): Scale fold factors of each gene by multiplying with (1 - divergence) of the gene.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ linear
<em>covered
</em>fraction
</strong>::Union{Float32, Float64} (required): The estimated linear fraction of the UMIs of each covered gene out of the total covered UMIs in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ scaled
<em>linear
</em>covered_fraction
</strong>::Union{Float32, Float64} (guaranteed): The estimated linear fraction of the UMIs of each covered gene out of the total covered UMIs in each block, scaled by divergence.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_covered_fractions!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_covered_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_covered_fractions!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_log_linear_covered_fractions!(
    daf::DafWriter;
    gene_fraction_regularization::AbstractFloat = ```1.0e-5```,
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The log base 2 of the estimated linear fraction of the UMIs of each covered gene in each block. This adds the 
<code>gene_fraction_regularization
</code> to deal with zero fractions.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ linear
<em>covered
</em>fraction
</strong>::Union{Float32, Float64} (required): The estimated linear fraction of the UMIs of each covered gene out of the total covered UMIs in each block.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ log
<em>linear
</em>covered_fraction
</strong>::Union{Float32, Float64} (guaranteed): The log base 2 of the estimated linear fraction of the UMIs of each covered gene out of the total covered UMIs in each block.
</p>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_covered_fractions!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_covered_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_covered_fractions!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_genes_log_scaled_linear_covered_fractions!(
    daf::DafWriter;
    gene_fraction_regularization::AbstractFloat = ```1.0e-5```,
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The estimated linear fraction of the UMIs of each covered gene in each block, scaled by divergence. We apply this scaling to reduce the disproportionate impact of highly variable (&quot;bursty&quot;) genes when using square-error methods.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>gene
</strong> (required): Sequenced genes.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ scaled
<em>linear
</em>covered_fraction
</strong>::Union{Float32, Float64} (required): The estimated linear fraction of the UMIs of each covered gene out of the total covered UMIs in each block, scaled by divergence.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Matrices
</strong>
</p>
<p>
<strong>gene, block @ log
<em>scaled
</em>linear
<em>covered
</em>fraction
</strong>::Union{Float32, Float64} (guaranteed): The log base 2 of the scaled estimated linear fraction of the UMIs of each covered gene out of the total covered UMIs in each block.
</p>
</div>
</section>
</article>
<h2 id="Genes">
<a class="docs-heading-anchor" href="#Genes">Genes
</a>
<a id="Genes-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Genes" title="Permalink">
</a>
</h2>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_is_neighborhood_markers!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_is_neighborhood_markers!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_is_neighborhood_markers!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">compute_blocks_genes_is_neighborhood_markers!(
    daf::DafWriter;
    min_marker_gene_max_fraction::AbstractFloat = ```0.0001```,
    min_marker_gene_range_fold::Real = ```2```,
    overwrite::Bool = false,
)::Nothing
</code>
</pre>
<p>A mask of genes that distinguish between cell states in each neighborhood. Otherwise similar to 
<a href="analyze_genes.html#Metacells.AnalyzeGenes.identify_marker_genes!">
<code>identify_marker_genes!
</code>
</a>.
</p>
<div class="admonition is-info" id="Note-d1f4feff2268b1c6">
<header class="admonition-header">Note
<a class="admonition-anchor" href="#Note-d1f4feff2268b1c6" title="Permalink">
</a>
</header>
<div class="admonition-body">
<p>This uses the virtual 
<a href="contracts.html#Metacells.Contracts.metacell_gene_fraction_matrix">
<code>metacell_gene_fraction_matrix
</code>
</a> and 
<a href="contracts.html#Metacells.Contracts.metacell_gene_log_fraction_matrix">
<code>metacell_gene_log_fraction_matrix
</code>
</a>. You will need an 
<code>adapter
</code> to map these to concrete fractions (geomean, linear, scaled, ...). Make sure you are consistent when mapping the fractions and log-fraction matrices.
</p>
</div>
</div>
</div>
</section>
</article>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_genes_is_environment_markers!" href="#Metacells.AnalyzeBlocks.compute_blocks_genes_is_environment_markers!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_is_environment_markers!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">compute_blocks_genes_is_environment_markers!(
    daf::DafWriter;
    min_marker_gene_max_fraction::AbstractFloat = ```0.0001```,
    min_marker_gene_range_fold::Real = ```2```,
    overwrite::Bool = false,
)::Nothing
</code>
</pre>
<p>A mask of genes that distinguish between cell states in each environment. Otherwise similar to 
<a href="analyze_genes.html#Metacells.AnalyzeGenes.identify_marker_genes!">
<code>identify_marker_genes!
</code>
</a>.
</p>
<div class="admonition is-info" id="Note-d1f4feff2268b1c6">
<header class="admonition-header">Note
<a class="admonition-anchor" href="#Note-d1f4feff2268b1c6" title="Permalink">
</a>
</header>
<div class="admonition-body">
<p>This uses the virtual 
<a href="contracts.html#Metacells.Contracts.metacell_gene_fraction_matrix">
<code>metacell_gene_fraction_matrix
</code>
</a> and 
<a href="contracts.html#Metacells.Contracts.metacell_gene_log_fraction_matrix">
<code>metacell_gene_log_fraction_matrix
</code>
</a>. You will need an 
<code>adapter
</code> to map these to concrete fractions (geomean, linear, scaled, ...). Make sure you are consistent when mapping the fractions and log-fraction matrices.
</p>
</div>
</div>
</div>
</section>
</article>
<h3 id="Metadata">
<a class="docs-heading-anchor" href="#Metadata">Metadata
</a>
<a id="Metadata-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Metadata" title="Permalink">
</a>
</h3>
<article class="docstring">
<header>
<a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring">
</a>
<a class="docstring-binding" id="Metacells.AnalyzeBlocks.compute_blocks_types!" href="#Metacells.AnalyzeBlocks.compute_blocks_types!">
<code>Metacells.AnalyzeBlocks.compute_blocks_types!
</code>
</a> — 
<span class="docstring-category">Function
</span>
<span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring">
</span>
</header>
<section>
<div>
<pre>
<code class="language-julia hljs">function compute_blocks_types!(
    daf::DafWriter;
    overwrite::Bool = ```false```,
)::Nothing
</code>
</pre>
<p>The type of each block, based on is metacell types.
</p>
<p>
<strong>Inputs
</strong>
</p>
<p>
<strong>Axes
</strong>
</p>
<p>
<strong>metacell
</strong> (required): Minimal-sized groups of cells for robust point estimates.
</p>
<p>
<strong>block
</strong> (required): Distinct groups of metacells with &quot;very close&quot; estimated cell state.
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>metacell @ block
</strong>::AbstractString (required): The unique block each metacell belongs to.
</p>
<p>
<strong>metacell @ type
</strong>::AbstractString (required): The type each metacell belongs to.
</p>
<p>
<strong>Outputs
</strong>
</p>
<p>
<strong>Vectors
</strong>
</p>
<p>
<strong>block @ type
</strong>::AbstractString (guaranteed): The type each block belongs to.
</p>
</div>
</section>
</article>
<h2 id="Index">
<a class="docs-heading-anchor" href="#Index">Index
</a>
<a id="Index-1">
</a>
<a class="docs-heading-anchor-permalink" href="#Index" title="Permalink">
</a>
</h2>
<ul>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks">
<code>Metacells.AnalyzeBlocks
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_covered_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_covered_UMIs!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_UMIs!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_is_environment_markers!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_is_environment_markers!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_is_neighborhood_markers!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_is_neighborhood_markers!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_linear_covered_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_linear_covered_fractions!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_linear_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_linear_fractions!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_covered_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_covered_fractions!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_log_linear_fractions!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_covered_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_covered_fractions!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_log_scaled_linear_fractions!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_covered_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_covered_fractions!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_fractions!">
<code>Metacells.AnalyzeBlocks.compute_blocks_genes_scaled_linear_fractions!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_n_cells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_cells!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_n_environment_blocks!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_environment_blocks!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_n_environment_cells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_environment_cells!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_n_environment_metacells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_environment_metacells!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_n_metacells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_metacells!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_blocks!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_blocks!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_cells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_cells!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_metacells!">
<code>Metacells.AnalyzeBlocks.compute_blocks_n_neighborhood_metacells!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_scaled_covered_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_scaled_covered_UMIs!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_scaled_total_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_scaled_total_UMIs!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_total_UMIs!">
<code>Metacells.AnalyzeBlocks.compute_blocks_total_UMIs!
</code>
</a>
</li>
<li>
<a href="analyze_blocks.html#Metacells.AnalyzeBlocks.compute_blocks_types!">
<code>Metacells.AnalyzeBlocks.compute_blocks_types!
</code>
</a>
</li>
</ul>
</article>
<nav class="docs-footer">
<a class="docs-footer-prevpage" href="compute_blocks.html">« Compute Blocks
</a>
<a class="docs-footer-nextpage" href="compute_modules.html">Compute Modules »
</a>
<div class="flexbox-break">
</div>
<p class="footer-message">Powered by 
<a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl
</a> and the 
<a href="https://julialang.org/">Julia Programming Language
</a>.
</p>
</nav>
</div>
<div class="modal" id="documenter-settings">
<div class="modal-background">
</div>
<div class="modal-card">
<header class="modal-card-head">
<p class="modal-card-title">Settings
</p>
<button class="delete">
</button>
</header>
<section class="modal-card-body">
<p>
<label class="label">Theme
</label>
<div class="select">
<select id="documenter-themepicker">
<option value="auto">Automatic (OS)
</option>
<option value="documenter-light">documenter-light
</option>
<option value="documenter-dark">documenter-dark
</option>
<option value="catppuccin-latte">catppuccin-latte
</option>
<option value="catppuccin-frappe">catppuccin-frappe
</option>
<option value="catppuccin-macchiato">catppuccin-macchiato
</option>
<option value="catppuccin-mocha">catppuccin-mocha
</option>
</select>
</div>
</p>
<hr/>
<p>This document was generated with 
<a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl
</a> version 1.12.0. Using Julia version 1.11.5.
</p>
</section>
<footer class="modal-card-foot">
</footer>
</div>
</div>
</div>
</body>
</html>
